# -*- coding: utf-8 -*-
import unittest
import json
from api.models import Card, CardList

class TestCardList(unittest.TestCase):

    def setUp(self):
        data = r'''[{"id":3636,"relatedCardId":0,"setNumber":15,"name":"Cloud Elemental","searchName":"cloudelemental","description":"Flying\nCloud Elemental can block only creatures with flying.","flavor":" \"You know you've angered the gods when the clouds turn against you.\" —Sisay, Captain of the Weatherlight","colors":["blue"],"manaCost":"2U","convertedManaCost":3,"cardSetName":"Visions","type":"Creature","subType":"Elemental","power":2,"toughness":3,"loyalty":0,"rarity":"Common","artist":"Adam Rex","cardSetId":"VIS","token":false,"promo":false,"rulings":[],"formats":[{"name":"Modern","legality":"Legal"},{"name":"Mirage Block","legality":"Legal"},{"name":"Legacy","legality":"Legal"},{"name":"Vintage","legality":"Legal"},{"name":"Freeform","legality":"Legal"},{"name":"Prismatic","legality":"Legal"},{"name":"Tribal Wars Legacy","legality":"Legal"},{"name":"Classic","legality":"Legal"},{"name":"Singleton 100","legality":"Legal"},{"name":"Commander","legality":"Legal"}],"releasedAt":"1997-02-03"},{"id":4253,"relatedCardId":0,"setNumber":32,"name":"Cloud Pirates","searchName":"cloudpirates","description":"Flying\nCloud Pirates can block only creatures with flying.","flavor":"","colors":["blue"],"manaCost":"U","convertedManaCost":1,"cardSetName":"Portal","type":"Creature","subType":"Human Pirate","power":1,"toughness":1,"loyalty":0,"rarity":"Common","artist":"Phil Foglio","cardSetId":"POR","token":false,"promo":false,"rulings":[],"formats":[{"name":"Legacy","legality":"Legal"},{"name":"Vintage","legality":"Legal"},{"name":"Commander","legality":"Legal"}],"releasedAt":"1997-06-01"},{"id":11588,"relatedCardId":0,"setNumber":29,"name":"Cloud of Faeries","searchName":"cloudoffaeries","description":"Flying\nWhen Cloud of Faeries enters the battlefield, untap up to two lands.\nCycling {2}({2}, Discard this card: Draw a card.)","flavor":"","colors":["blue"],"manaCost":"1U","convertedManaCost":2,"cardSetName":"Urza's Legacy","type":"Creature","subType":"Faerie","power":1,"toughness":1,"loyalty":0,"rarity":"Common","artist":"Melissa A. Benson","cardSetId":"ULG","token":false,"promo":false,"rulings":[{"releasedAt":"2004-10-04","rule":"You can untap another player's lands."},{"releasedAt":"2004-10-04","rule":"This does not target the lands."},{"releasedAt":"2004-10-04","rule":"You can untap 0, 1, or 2 lands."},{"releasedAt":"2008-10-01","rule":"Cycling is an activated ability. Effects that interact with activated abilities (such as Stifle or Rings of Brighthearth) will interact with cycling. Effects that interact with spells (such as Remove Soul or Faerie Tauntings) will not."}],"formats":[{"name":"Urza Block","legality":"Legal"},{"name":"Legacy","legality":"Legal"},{"name":"Vintage","legality":"Legal"},{"name":"Commander","legality":"Legal"}],"releasedAt":"1999-02-15"},{"id":19563,"relatedCardId":0,"setNumber":67,"name":"Cloud Sprite","searchName":"cloudsprite","description":"Flying (This creature can't be blocked except by creatures with flying or reach.)\nCloud Sprite can block only creatures with flying.","flavor":" The delicate sprites carry messages for Saprazzans, but they refuse to land in Mercadia City's filthy markets.","colors":["blue"],"manaCost":"U","convertedManaCost":1,"cardSetName":"Mercadian Masques","type":"Creature","subType":"Faerie","power":1,"toughness":1,"loyalty":0,"rarity":"Common","artist":"Mark Zug","cardSetId":"MMQ","token":false,"promo":false,"rulings":[],"formats":[{"name":"Modern","legality":"Legal"},{"name":"Masques Block","legality":"Legal"},{"name":"Legacy","legality":"Legal"},{"name":"Vintage","legality":"Legal"},{"name":"Freeform","legality":"Legal"},{"name":"Prismatic","legality":"Legal"},{"name":"Tribal Wars Legacy","legality":"Legal"},{"name":"Classic","legality":"Legal"},{"name":"Singleton 100","legality":"Legal"},{"name":"Commander","legality":"Legal"}],"releasedAt":"1999-10-04"},{"id":21280,"relatedCardId":0,"setNumber":29,"name":"Cloudskate","searchName":"cloudskate","description":"Flying\nFading 3 (This creature enters the battlefield with three fade counters on it. At the beginning of your upkeep, remove a fade counter from it. If you can't, sacrifice it.)","flavor":"","colors":["blue"],"manaCost":"1U","convertedManaCost":2,"cardSetName":"Nemesis","type":"Creature","subType":"Illusion","power":2,"toughness":2,"loyalty":0,"rarity":"Common","artist":"Carl Critchlow","cardSetId":"NEM","token":false,"promo":false,"rulings":[],"formats":[{"name":"Masques Block","legality":"Legal"},{"name":"Legacy","legality":"Legal"},{"name":"Vintage","legality":"Legal"},{"name":"Commander","legality":"Legal"}],"releasedAt":"2000-02-14"},{"id":27247,"relatedCardId":0,"setNumber":11,"name":"Cloud Elemental","searchName":"cloudelemental","description":"Flying\nCloud Elemental can block only creatures with flying.","flavor":" \"You know you've angered the gods when the clouds turn against you.\" —Sisay, Captain of the Weatherlight","colors":["blue"],"manaCost":"2U","convertedManaCost":3,"cardSetName":"Beatdown Box Set","type":"Creature","subType":"Elemental","power":2,"toughness":3,"loyalty":0,"rarity":"Common","artist":"Adam Rex","cardSetId":"BTD","token":false,"promo":false,"rulings":[],"formats":[{"name":"Modern","legality":"Legal"},{"name":"Mirage Block","legality":"Legal"},{"name":"Legacy","legality":"Legal"},{"name":"Vintage","legality":"Legal"},{"name":"Freeform","legality":"Legal"},{"name":"Prismatic","legality":"Legal"},{"name":"Tribal Wars Legacy","legality":"Legal"},{"name":"Classic","legality":"Legal"},{"name":"Singleton 100","legality":"Legal"},{"name":"Commander","legality":"Legal"}],"releasedAt":"2000-12-01"},{"id":50301,"relatedCardId":0,"setNumber":86,"name":"Soratami Cloudskater","searchName":"soratamicloudskater","description":"Flying\n{2}, Return a land you control to its owner's hand: Draw a card, then discard a card.","flavor":" \"You hide your actions from eyes on the ground, but nothing escapes the clouds.\"","colors":["blue"],"manaCost":"1U","convertedManaCost":2,"cardSetName":"Champions of Kamigawa","type":"Creature","subType":"Moonfolk Rogue","power":1,"toughness":1,"loyalty":0,"rarity":"Common","artist":"Michael Sutfin","cardSetId":"CHK","token":false,"promo":false,"rulings":[],"formats":[{"name":"Modern","legality":"Legal"},{"name":"Kamigawa Block","legality":"Legal"},{"name":"Legacy","legality":"Legal"},{"name":"Vintage","legality":"Legal"},{"name":"Freeform","legality":"Legal"},{"name":"Prismatic","legality":"Legal"},{"name":"Tribal Wars Legacy","legality":"Legal"},{"name":"Classic","legality":"Legal"},{"name":"Singleton 100","legality":"Legal"},{"name":"Commander","legality":"Legal"}],"releasedAt":"2004-10-01"},{"id":75268,"relatedCardId":0,"setNumber":74,"name":"Meloku the Clouded Mirror","searchName":"melokuthecloudedmirror","description":"Flying\n{1}, Return a land you control to its owner's hand: Put a 1/1 blue Illusion creature token with flying onto the battlefield.","flavor":" He loved his cities in the clouds. When he traveled to the lands below, he brought many reminders of his home.","colors":["blue"],"manaCost":"4U","convertedManaCost":5,"cardSetName":"Champions of Kamigawa","type":"Legendary Creature","subType":"Moonfolk Wizard","power":2,"toughness":4,"loyalty":0,"rarity":"Rare","artist":"Scott M. Fischer","cardSetId":"CHK","token":false,"promo":false,"rulings":[],"formats":[{"name":"Modern","legality":"Legal"},{"name":"Kamigawa Block","legality":"Legal"},{"name":"Legacy","legality":"Legal"},{"name":"Vintage","legality":"Legal"},{"name":"Freeform","legality":"Legal"},{"name":"Prismatic","legality":"Legal"},{"name":"Tribal Wars Legacy","legality":"Legal"},{"name":"Classic","legality":"Legal"},{"name":"Singleton 100","legality":"Legal"},{"name":"Commander","legality":"Legal"}],"releasedAt":"2004-10-01"},{"id":97097,"relatedCardId":0,"setNumber":125,"name":"Pride of the Clouds","searchName":"prideoftheclouds","description":"Flying\nPride of the Clouds gets +1/+1 for each other creature with flying on the battlefield.\nForecast - {2}{White}{Blue}, Reveal Pride of the Clouds from your hand: Put a 1/1 white and blue Bird creature token with flying onto the battlefield. (Activate this ability only during your upkeep and only once each turn.)","flavor":"","colors":["blue","white"],"manaCost":"WU","convertedManaCost":2,"cardSetName":"Dissension","type":"Creature","subType":"Elemental Cat","power":1,"toughness":1,"loyalty":0,"rarity":"Rare","artist":"Rebecca Guay","cardSetId":"DIS","token":false,"promo":false,"rulings":[],"formats":[{"name":"Modern","legality":"Legal"},{"name":"Ravnica Block","legality":"Legal"},{"name":"Legacy","legality":"Legal"},{"name":"Vintage","legality":"Legal"},{"name":"Freeform","legality":"Legal"},{"name":"Prismatic","legality":"Legal"},{"name":"Tribal Wars Legacy","legality":"Legal"},{"name":"Classic","legality":"Legal"},{"name":"Singleton 100","legality":"Legal"},{"name":"Commander","legality":"Legal"}],"releasedAt":"2006-05-05"},{"id":109715,"relatedCardId":0,"setNumber":73,"name":"Riftwing Cloudskate","searchName":"riftwingcloudskate","description":"Flying\nWhen Riftwing Cloudskate enters the battlefield, return target permanent to its owner's hand.\nSuspend 3-{1}{Blue}(Rather than cast this card from your hand, you may pay {1}{Blue} and exile it with three time counters on it. At the beginning of your upkeep, remove a time counter. When the last is removed, cast it without paying its mana cost. It has haste.)","flavor":"","colors":["blue"],"manaCost":"3UU","convertedManaCost":5,"cardSetName":"Time Spiral","type":"Creature","subType":"Illusion","power":2,"toughness":2,"loyalty":0,"rarity":"Uncommon","artist":"Carl Critchlow","cardSetId":"TSP","token":false,"promo":false,"rulings":[{"releasedAt":"2013-06-07","rule":"You can exile a card in your hand using suspend any time you could cast that card. Consider its card type, any effect that affects when you could cast it (such as flash) and any other effects that could stop you from casting it (such as Meddling Mage's effect) to determine if and when you can do this. Whether or not you could actually complete all steps in casting the card is irrelevant. For example, you can exile a card with suspend that has no mana cost or requires a target even if no legal targets are available at that time."},{"releasedAt":"2013-06-07","rule":"Exiling a card with suspend isn't casting that card. This action doesn't use the stack and can't be responded to."},{"releasedAt":"2013-06-07","rule":"If the spell requires any targets, those targets are chosen when the spell is finally cast, not when it's exiled."},{"releasedAt":"2013-06-07","rule":"If the first triggered ability of suspend (the one that removes time counters) is countered, no time counter is removed. The ability will trigger again during the card's owner's next upkeep."},{"releasedAt":"2013-06-07","rule":"When the last time counter is removed, the second triggered ability of suspend will trigger. It doesn't matter why the last time counter was removed or what effect removed it."},{"releasedAt":"2013-06-07","rule":"If the second triggered ability of suspend (the one that lets you cast the card) is countered, the card can't be cast. It remains exiled with no time counters on it, and it's no longer suspended."},{"releasedAt":"2013-06-07","rule":"As the second triggered ability resolves, you must cast the card if able. Timing restrictions based on the card's type are ignored."},{"releasedAt":"2013-06-07","rule":"If you can't cast the card, perhaps because there are no legal targets available, it remains exiled with no time counters on it, and it's no longer suspended."},{"releasedAt":"2013-06-07","rule":"If the spell has any mandatory additional costs, you must pay those if able. However, if an additional cost includes a mana payment, you are forced to pay that cost only if there's enough mana in your mana pool at the time you cast the spell. You aren't forced to activate any mana abilities, although you may do so if you wish."},{"releasedAt":"2013-06-07","rule":"A creature cast using suspend will enter the battlefield with haste. It will have haste until another player gains control of it (or, in some rare cases, gains control of the creature spell itself)."}],"formats":[{"name":"Modern","legality":"Legal"},{"name":"Time Spiral Block","legality":"Legal"},{"name":"Legacy","legality":"Legal"},{"name":"Vintage","legality":"Legal"},{"name":"Freeform","legality":"Legal"},{"name":"Prismatic","legality":"Legal"},{"name":"Tribal Wars Legacy","legality":"Legal"},{"name":"Classic","legality":"Legal"},{"name":"Singleton 100","legality":"Legal"},{"name":"Commander","legality":"Legal"}],"releasedAt":"2006-11-06"},{"id":129804,"relatedCardId":0,"setNumber":74,"name":"Cloud Elemental","searchName":"cloudelemental","description":"Flying\nCloud Elemental can block only creatures with flying.","flavor":" The soratami surround their sky-castles with living clouds that serve as both sword and shield.","colors":["blue"],"manaCost":"2U","convertedManaCost":3,"cardSetName":"Tenth Edition","type":"Creature","subType":"Elemental","power":2,"toughness":3,"loyalty":0,"rarity":"Common","artist":"Michael Sutfin","cardSetId":"10E","token":false,"promo":false,"rulings":[],"formats":[{"name":"Modern","legality":"Legal"},{"name":"Mirage Block","legality":"Legal"},{"name":"Legacy","legality":"Legal"},{"name":"Vintage","legality":"Legal"},{"name":"Freeform","legality":"Legal"},{"name":"Prismatic","legality":"Legal"},{"name":"Tribal Wars Legacy","legality":"Legal"},{"name":"Classic","legality":"Legal"},{"name":"Singleton 100","legality":"Legal"},{"name":"Commander","legality":"Legal"}],"releasedAt":"2007-07-13"},{"id":130309,"relatedCardId":0,"setNumber":33,"name":"Cloudseeder","searchName":"cloudseeder","description":"Flying\n{Blue}, {Tap}, Discard a card: Put a 1/1 blue Faerie creature token named Cloud Sprite onto the battlefield. It has flying and \"Cloud Sprite can block only creatures with flying.\"","flavor":"","colors":["blue"],"manaCost":"1U","convertedManaCost":2,"cardSetName":"Future Sight","type":"Creature","subType":"Faerie Spellshaper","power":1,"toughness":1,"loyalty":0,"rarity":"Uncommon","artist":"Tsutomu Kawade","cardSetId":"FUT","token":false,"promo":false,"rulings":[],"formats":[{"name":"Modern","legality":"Legal"},{"name":"Time Spiral Block","legality":"Legal"},{"name":"Legacy","legality":"Legal"},{"name":"Vintage","legality":"Legal"},{"name":"Freeform","legality":"Legal"},{"name":"Prismatic","legality":"Legal"},{"name":"Tribal Wars Legacy","legality":"Legal"},{"name":"Classic","legality":"Legal"},{"name":"Singleton 100","legality":"Legal"},{"name":"Commander","legality":"Legal"}],"releasedAt":"2007-05-04"},{"id":132069,"relatedCardId":0,"setNumber":75,"name":"Cloud Sprite","searchName":"cloudsprite","description":"Flying (This creature can't be blocked except by creatures with flying or reach.)\nCloud Sprite can block only creatures with flying.","flavor":" The delicate sprites carry messages for Saprazzans, but they refuse to land in Mercadia City's filthy markets.","colors":["blue"],"manaCost":"U","convertedManaCost":1,"cardSetName":"Tenth Edition","type":"Creature","subType":"Faerie","power":1,"toughness":1,"loyalty":0,"rarity":"Common","artist":"Mark Zug","cardSetId":"10E","token":false,"promo":false,"rulings":[],"formats":[{"name":"Modern","legality":"Legal"},{"name":"Masques Block","legality":"Legal"},{"name":"Legacy","legality":"Legal"},{"name":"Vintage","legality":"Legal"},{"name":"Freeform","legality":"Legal"},{"name":"Prismatic","legality":"Legal"},{"name":"Tribal Wars Legacy","legality":"Legal"},{"name":"Classic","legality":"Legal"},{"name":"Singleton 100","legality":"Legal"},{"name":"Commander","legality":"Legal"}],"releasedAt":"2007-07-13"},{"id":189249,"relatedCardId":0,"setNumber":15,"name":"Riftwing Cloudskate","searchName":"riftwingcloudskate","description":"Flying\nWhen Riftwing Cloudskate enters the battlefield, return target permanent to its owner's hand.\nSuspend 3-{1}{Blue}(Rather than cast this card from your hand, you may pay {1}{Blue} and exile it with three time counters on it. At the beginning of your upkeep, remove a time counter. When the last is removed, cast it without paying its mana cost. It has haste.)","flavor":"","colors":["blue"],"manaCost":"3UU","convertedManaCost":5,"cardSetName":"Duel Decks: Jace vs. Chandra","type":"Creature","subType":"Illusion","power":2,"toughness":2,"loyalty":0,"rarity":"Uncommon","artist":"Carl Critchlow","cardSetId":"DD2","token":false,"promo":false,"rulings":[{"releasedAt":"2013-06-07","rule":"You can exile a card in your hand using suspend any time you could cast that card. Consider its card type, any effect that affects when you could cast it (such as flash) and any other effects that could stop you from casting it (such as Meddling Mage's effect) to determine if and when you can do this. Whether or not you could actually complete all steps in casting the card is irrelevant. For example, you can exile a card with suspend that has no mana cost or requires a target even if no legal targets are available at that time."},{"releasedAt":"2013-06-07","rule":"Exiling a card with suspend isn't casting that card. This action doesn't use the stack and can't be responded to."},{"releasedAt":"2013-06-07","rule":"If the spell requires any targets, those targets are chosen when the spell is finally cast, not when it's exiled."},{"releasedAt":"2013-06-07","rule":"If the first triggered ability of suspend (the one that removes time counters) is countered, no time counter is removed. The ability will trigger again during the card's owner's next upkeep."},{"releasedAt":"2013-06-07","rule":"When the last time counter is removed, the second triggered ability of suspend will trigger. It doesn't matter why the last time counter was removed or what effect removed it."},{"releasedAt":"2013-06-07","rule":"If the second triggered ability of suspend (the one that lets you cast the card) is countered, the card can't be cast. It remains exiled with no time counters on it, and it's no longer suspended."},{"releasedAt":"2013-06-07","rule":"As the second triggered ability resolves, you must cast the card if able. Timing restrictions based on the card's type are ignored."},{"releasedAt":"2013-06-07","rule":"If you can't cast the card, perhaps because there are no legal targets available, it remains exiled with no time counters on it, and it's no longer suspended."},{"releasedAt":"2013-06-07","rule":"If the spell has any mandatory additional costs, you must pay those if able. However, if an additional cost includes a mana payment, you are forced to pay that cost only if there's enough mana in your mana pool at the time you cast the spell. You aren't forced to activate any mana abilities, although you may do so if you wish."},{"releasedAt":"2013-06-07","rule":"A creature cast using suspend will enter the battlefield with haste. It will have haste until another player gains control of it (or, in some rare cases, gains control of the creature spell itself)."}],"formats":[{"name":"Modern","legality":"Legal"},{"name":"Time Spiral Block","legality":"Legal"},{"name":"Legacy","legality":"Legal"},{"name":"Vintage","legality":"Legal"},{"name":"Freeform","legality":"Legal"},{"name":"Prismatic","legality":"Legal"},{"name":"Tribal Wars Legacy","legality":"Legal"},{"name":"Classic","legality":"Legal"},{"name":"Singleton 100","legality":"Legal"},{"name":"Commander","legality":"Legal"}],"releasedAt":"2008-11-07"},{"id":208224,"relatedCardId":0,"setNumber":50,"name":"Cloud Elemental","searchName":"cloudelemental","description":"Flying\nCloud Elemental can block only creatures with flying.","flavor":" \"The sky teems with just as much life as the forest or the deep seas.\" —Hadi Kasten, Calla Dale naturalist","colors":["blue"],"manaCost":"2U","convertedManaCost":3,"cardSetName":"Magic 2011","type":"Creature","subType":"Elemental","power":2,"toughness":3,"loyalty":0,"rarity":"Common","artist":"Michael Sutfin","cardSetId":"M11","token":false,"promo":false,"rulings":[],"formats":[{"name":"Modern","legality":"Legal"},{"name":"Mirage Block","legality":"Legal"},{"name":"Legacy","legality":"Legal"},{"name":"Vintage","legality":"Legal"},{"name":"Freeform","legality":"Legal"},{"name":"Prismatic","legality":"Legal"},{"name":"Tribal Wars Legacy","legality":"Legal"},{"name":"Classic","legality":"Legal"},{"name":"Singleton 100","legality":"Legal"},{"name":"Commander","legality":"Legal"}],"releasedAt":"2010-07-16"},{"id":366403,"relatedCardId":0,"setNumber":32,"name":"Cloudfin Raptor","searchName":"cloudfinraptor","description":"Flying\nEvolve (Whenever a creature enters the battlefield under your control, if that creature has greater power or toughness than this creature, put a +1/+1 counter on this creature.)","flavor":"","colors":["blue"],"manaCost":"U","convertedManaCost":1,"cardSetName":"Gatecrash","type":"Creature","subType":"Bird Mutant","power":0,"toughness":1,"loyalty":0,"rarity":"Common","artist":"Peter Mohrbacher","cardSetId":"GTC","token":false,"promo":false,"rulings":[{"releasedAt":"2013-04-15","rule":"When comparing the stats of the two creatures for evolve, you always compare power to power and toughness to toughness."},{"releasedAt":"2013-04-15","rule":"Whenever a creature enters the battlefield under your control, check its power and toughness against the power and toughness of the creature with evolve. If neither stat of the new creature is greater, evolve won't trigger at all."},{"releasedAt":"2013-04-15","rule":"If evolve triggers, the stat comparison will happen again when the ability tries to resolve. If neither stat of the new creature is greater, the ability will do nothing. If the creature that entered the battlefield leaves the battlefield before evolve tries to resolve, use its last known power and toughness to compare the stats."},{"releasedAt":"2013-04-15","rule":"If a creature enters the battlefield with +1/+1 counters on it, consider those counters when determining if evolve will trigger. For example, a 1/1 creature that enters the battlefield with two +1/+1 counters on it will cause the evolve ability of a 2/2 creature to trigger."},{"releasedAt":"2013-04-15","rule":"If multiple creatures enter the battlefield at the same time, evolve may trigger multiple times, although the stat comparison will take place each time one of those abilities tries to resolve. For example, if you control a 2/2 creature with evolve and two 3/3 creatures enter the battlefield, evolve will trigger twice. The first ability will resolve and put a +1/+1 counter on the creature with evolve. When the second ability tries to resolve, neither the power nor the toughness of the new creature is greater than that of the creature with evolve, so that ability does nothing."},{"releasedAt":"2013-04-15","rule":"When comparing the stats as the evolve ability resolves, it's possible that the stat that's greater changes from power to toughness or vice versa. If this happens, the ability will still resolve and you'll put a +1/+1 counter on the creature with evolve. For example, if you control a 2/2 creature with evolve and a 1/3 creature enters the battlefield under your control, it toughness is greater so evolve will trigger. In response, the 1/3 creature gets +2/-2. When the evolve trigger tries to resolve, its power is greater. You'll put a +1/+1 counter on the creature with evolve."}],"formats":[{"name":"Standard","legality":"Legal"},{"name":"Modern","legality":"Legal"},{"name":"Extended","legality":"Legal"},{"name":"Return to Ravnica Block","legality":"Legal"},{"name":"Legacy","legality":"Legal"},{"name":"Vintage","legality":"Legal"},{"name":"Freeform","legality":"Legal"},{"name":"Prismatic","legality":"Legal"},{"name":"Tribal Wars Legacy","legality":"Legal"},{"name":"Tribal Wars Standard","legality":"Legal"},{"name":"Classic","legality":"Legal"},{"name":"Singleton 100","legality":"Legal"},{"name":"Commander","legality":"Legal"}],"releasedAt":"2013-02-01"},{"id":370350,"relatedCardId":0,"setNumber":62,"name":"Riftwing Cloudskate","searchName":"riftwingcloudskate","description":"Flying\nWhen Riftwing Cloudskate enters the battlefield, return target permanent to its owner's hand.\nSuspend 3-{1}{Blue}(Rather than cast this card from your hand, you may pay {1}{Blue} and exile it with three time counters on it. At the beginning of your upkeep, remove a time counter. When the last is removed, cast it without paying its mana cost. It has haste.)","flavor":"","colors":["blue"],"manaCost":"3UU","convertedManaCost":5,"cardSetName":"Modern Masters","type":"Creature","subType":"Illusion","power":2,"toughness":2,"loyalty":0,"rarity":"Uncommon","artist":"Carl Critchlow","cardSetId":"MMA","token":false,"promo":false,"rulings":[{"releasedAt":"2013-06-07","rule":"You can exile a card in your hand using suspend any time you could cast that card. Consider its card type, any effect that affects when you could cast it (such as flash) and any other effects that could stop you from casting it (such as Meddling Mage's effect) to determine if and when you can do this. Whether or not you could actually complete all steps in casting the card is irrelevant. For example, you can exile a card with suspend that has no mana cost or requires a target even if no legal targets are available at that time."},{"releasedAt":"2013-06-07","rule":"Exiling a card with suspend isn't casting that card. This action doesn't use the stack and can't be responded to."},{"releasedAt":"2013-06-07","rule":"If the spell requires any targets, those targets are chosen when the spell is finally cast, not when it's exiled."},{"releasedAt":"2013-06-07","rule":"If the first triggered ability of suspend (the one that removes time counters) is countered, no time counter is removed. The ability will trigger again during the card's owner's next upkeep."},{"releasedAt":"2013-06-07","rule":"When the last time counter is removed, the second triggered ability of suspend will trigger. It doesn't matter why the last time counter was removed or what effect removed it."},{"releasedAt":"2013-06-07","rule":"If the second triggered ability of suspend (the one that lets you cast the card) is countered, the card can't be cast. It remains exiled with no time counters on it, and it's no longer suspended."},{"releasedAt":"2013-06-07","rule":"As the second triggered ability resolves, you must cast the card if able. Timing restrictions based on the card's type are ignored."},{"releasedAt":"2013-06-07","rule":"If you can't cast the card, perhaps because there are no legal targets available, it remains exiled with no time counters on it, and it's no longer suspended."},{"releasedAt":"2013-06-07","rule":"If the spell has any mandatory additional costs, you must pay those if able. However, if an additional cost includes a mana payment, you are forced to pay that cost only if there's enough mana in your mana pool at the time you cast the spell. You aren't forced to activate any mana abilities, although you may do so if you wish."},{"releasedAt":"2013-06-07","rule":"A creature cast using suspend will enter the battlefield with haste. It will have haste until another player gains control of it (or, in some rare cases, gains control of the creature spell itself)."}],"formats":[{"name":"Modern","legality":"Legal"},{"name":"Time Spiral Block","legality":"Legal"},{"name":"Legacy","legality":"Legal"},{"name":"Vintage","legality":"Legal"},{"name":"Freeform","legality":"Legal"},{"name":"Prismatic","legality":"Legal"},{"name":"Tribal Wars Legacy","legality":"Legal"},{"name":"Classic","legality":"Legal"},{"name":"Singleton 100","legality":"Legal"},{"name":"Commander","legality":"Legal"}],"releasedAt":"2013-07-07"},{"id":370385,"relatedCardId":0,"setNumber":52,"name":"Meloku the Clouded Mirror","searchName":"melokuthecloudedmirror","description":"Flying\n{1}, Return a land you control to its owner's hand: Put a 1/1 blue Illusion creature token with flying onto the battlefield.","flavor":" He loved his cities in the clouds. When he traveled to the lands below, he brought many reminders of his home.","colors":["blue"],"manaCost":"4U","convertedManaCost":5,"cardSetName":"Modern Masters","type":"Legendary Creature","subType":"Moonfolk Wizard","power":2,"toughness":4,"loyalty":0,"rarity":"Rare","artist":"Scott M. Fischer","cardSetId":"MMA","token":false,"promo":false,"rulings":[],"formats":[{"name":"Modern","legality":"Legal"},{"name":"Kamigawa Block","legality":"Legal"},{"name":"Legacy","legality":"Legal"},{"name":"Vintage","legality":"Legal"},{"name":"Freeform","legality":"Legal"},{"name":"Prismatic","legality":"Legal"},{"name":"Tribal Wars Legacy","legality":"Legal"},{"name":"Classic","legality":"Legal"},{"name":"Singleton 100","legality":"Legal"},{"name":"Commander","legality":"Legal"}],"releasedAt":"2013-07-07"},{"id":380197,"relatedCardId":0,"setNumber":18,"name":"Riftwing Cloudskate","searchName":"riftwingcloudskate","description":"Flying\nWhen Riftwing Cloudskate enters the battlefield, return target permanent to its owner's hand.\nSuspend 3-{1}{Blue}(Rather than cast this card from your hand, you may pay {1}{Blue} and exile it with three time counters on it. At the beginning of your upkeep, remove a time counter. When the last is removed, cast it without paying its mana cost. It has haste.)","flavor":"","colors":["blue"],"manaCost":"3UU","convertedManaCost":5,"cardSetName":"Duel Decks: Jace vs. Vraska","type":"Creature","subType":"Illusion","power":2,"toughness":2,"loyalty":0,"rarity":"Uncommon","artist":"Carl Critchlow","cardSetId":"DDM","token":false,"promo":false,"rulings":[{"releasedAt":"2013-06-07","rule":"You can exile a card in your hand using suspend any time you could cast that card. Consider its card type, any effect that affects when you could cast it (such as flash) and any other effects that could stop you from casting it (such as Meddling Mage's effect) to determine if and when you can do this. Whether or not you could actually complete all steps in casting the card is irrelevant. For example, you can exile a card with suspend that has no mana cost or requires a target even if no legal targets are available at that time."},{"releasedAt":"2013-06-07","rule":"Exiling a card with suspend isn't casting that card. This action doesn't use the stack and can't be responded to."},{"releasedAt":"2013-06-07","rule":"If the spell requires any targets, those targets are chosen when the spell is finally cast, not when it's exiled."},{"releasedAt":"2013-06-07","rule":"If the first triggered ability of suspend (the one that removes time counters) is countered, no time counter is removed. The ability will trigger again during the card's owner's next upkeep."},{"releasedAt":"2013-06-07","rule":"When the last time counter is removed, the second triggered ability of suspend will trigger. It doesn't matter why the last time counter was removed or what effect removed it."},{"releasedAt":"2013-06-07","rule":"If the second triggered ability of suspend (the one that lets you cast the card) is countered, the card can't be cast. It remains exiled with no time counters on it, and it's no longer suspended."},{"releasedAt":"2013-06-07","rule":"As the second triggered ability resolves, you must cast the card if able. Timing restrictions based on the card's type are ignored."},{"releasedAt":"2013-06-07","rule":"If you can't cast the card, perhaps because there are no legal targets available, it remains exiled with no time counters on it, and it's no longer suspended."},{"releasedAt":"2013-06-07","rule":"If the spell has any mandatory additional costs, you must pay those if able. However, if an additional cost includes a mana payment, you are forced to pay that cost only if there's enough mana in your mana pool at the time you cast the spell. You aren't forced to activate any mana abilities, although you may do so if you wish."},{"releasedAt":"2013-06-07","rule":"A creature cast using suspend will enter the battlefield with haste. It will have haste until another player gains control of it (or, in some rare cases, gains control of the creature spell itself)."}],"formats":[{"name":"Modern","legality":"Legal"},{"name":"Time Spiral Block","legality":"Legal"},{"name":"Legacy","legality":"Legal"},{"name":"Vintage","legality":"Legal"},{"name":"Freeform","legality":"Legal"},{"name":"Prismatic","legality":"Legal"},{"name":"Tribal Wars Legacy","legality":"Legal"},{"name":"Classic","legality":"Legal"},{"name":"Singleton 100","legality":"Legal"},{"name":"Commander","legality":"Legal"}],"releasedAt":"2014-03-14"},{"id":382893,"relatedCardId":0,"setNumber":62,"name":"Cloud of Faeries","searchName":"cloudoffaeries","description":"Flying\nWhen Cloud of Faeries enters the battlefield, untap up to two lands.\nCycling {2} ({2}, Discard this card: Draw a card.)","flavor":"","colors":["blue"],"manaCost":"1U","convertedManaCost":2,"cardSetName":"Vintage Masters","type":"Creature","subType":"Faerie","power":1,"toughness":1,"loyalty":0,"rarity":"Uncommon","artist":"Melissa A. Benson","cardSetId":"VMA","token":false,"promo":false,"rulings":[{"releasedAt":"2004-10-04","rule":"You can untap another player's lands."},{"releasedAt":"2004-10-04","rule":"This does not target the lands."},{"releasedAt":"2004-10-04","rule":"You can untap 0, 1, or 2 lands."},{"releasedAt":"2008-10-01","rule":"Cycling is an activated ability. Effects that interact with activated abilities (such as Stifle or Rings of Brighthearth) will interact with cycling. Effects that interact with spells (such as Remove Soul or Faerie Tauntings) will not."}],"formats":[{"name":"Urza Block","legality":"Legal"},{"name":"Legacy","legality":"Legal"},{"name":"Vintage","legality":"Legal"},{"name":"Freeform","legality":"Legal"},{"name":"Prismatic","legality":"Legal"},{"name":"Commander","legality":"Legal"}],"releasedAt":"2014-05-16"}]'''


        data_json = json.loads(data)
        cards = []
        for card_data in data_json:
            cards.append(Card(card_data))

        self.cardlist = CardList(cards)

    def test_correct_length(self):
        self.assertEquals(len(self.cardlist), 20)

    def test_access_by_string_index_with_one_result(self):
        c = self.cardlist["Cloud Pirates"]
        self.assertEquals(type(c[0]), Card)

    def test_access_by_string_index_with_multiple_results(self):
        c = self.cardlist["Cloud of Faeries"]
        self.assertTrue( len(c) > 1 )
        for card in c:
            self.assertEquals(card.name, "Cloud of Faeries")

    def test_access_by_integer_index(self):
        c = self.cardlist[6]
        self.assertEquals(c.name, "Soratami Cloudskater")

    def test_copy_card_list(self):
        copy_list = self.cardlist.copy()
        copy_list.cards = copy_list.cards[0:-1]
        self.assertEquals( len(copy_list.cards), len(self.cardlist.cards) -1 )

        copy_list.cards[0].name = "CHANGED_NAME"
        self.assertFalse( copy_list.cards[0].name == self.cardlist.cards[0].name )

    def test_remove_reprints_without_keep_sets(self):
        '''DEPENDS ON COPY FUNCTION, IF test_copy_card_list FAILS WITH THIS, FIX COPY FIRST'''

        l = {}
        for card in self.cardlist:
            if card.name in l:
                l[card.name] += 1
            else:
                l[card.name] = 1

        number_of_reprints = 0
        for key in l:
            number_of_reprints += (l[key] - 1)

        cl = self.cardlist.copy()
        cl.remove_reprints()

        self.assertEquals(len(cl.cards), len(self.cardlist.cards) - number_of_reprints)

    def test_remove_reprints_with_keep_sets(self):
        keep_sets = ['VIS']

        copy_list = self.cardlist.copy()
        copy_list.remove_reprints(prefer_sets=keep_sets)

        # there are 11 unique cards in the list
        self.assertEquals( len(copy_list.cards), 11 )

        self.assertEquals( len(copy_list["Cloud Elemental"]), 1 )
        self.assertEquals( copy_list["Cloud Elemental"][0].card_set_id, "VIS")
